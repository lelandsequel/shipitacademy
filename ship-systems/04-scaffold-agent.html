<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 04: Scaffold Agent — Ship OS | ShipItAcademy.com</title>
    <meta name="robots" content="noindex, nofollow">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>⚙️</text></svg>">
    <style>
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #0A0A0A;
            --bg-elevated: #111111;
            --bg-card: #161616;
            --border: #222222;
            --text-primary: #EDEDED;
            --text-secondary: #888888;
            --text-tertiary: #555555;
            --accent: #d4a853;
            --accent-dim: rgba(212, 168, 83, 0.12);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        a {
            color: var(--accent);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 24px;
        }

        nav {
            border-bottom: 1px solid var(--border);
            padding: 20px 0;
        }

        nav .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 15px;
            font-weight: 600;
            letter-spacing: -0.02em;
            color: var(--text-primary);
        }

        .nav-link {
            font-size: 14px;
            color: var(--text-secondary);
            transition: color 0.15s;
        }

        .nav-link:hover {
            color: var(--text-primary);
            text-decoration: none;
        }

        .back-link {
            display: inline-block;
            font-size: 14px;
            color: var(--accent);
            margin: 32px 0 0;
            font-weight: 600;
        }

        .track-badge {
            display: inline-block;
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: 4px 10px;
            border-radius: 4px;
            margin: 40px 0 16px;
        }

        .track-a {
            background: rgba(212, 168, 83, 0.12);
            color: #d4a853;
        }

        .content {
            padding: 0 0 80px;
        }

        .content h1 {
            font-size: 40px;
            font-weight: 700;
            letter-spacing: -0.035em;
            line-height: 1.15;
            margin-bottom: 40px;
        }

        .content h2 {
            font-size: 26px;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin: 48px 0 16px;
        }

        .content h3 {
            font-size: 20px;
            font-weight: 700;
            letter-spacing: -0.01em;
            margin: 32px 0 12px;
        }

        .content h4 {
            font-size: 16px;
            font-weight: 700;
            margin: 24px 0 8px;
        }

        .content p {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 16px;
            max-width: 680px;
        }

        .content ul, .content ol {
            margin: 0 0 16px 24px;
            color: var(--text-secondary);
        }

        .content li {
            font-size: 15px;
            line-height: 1.7;
            margin-bottom: 6px;
        }

        .content blockquote {
            border-left: 3px solid var(--accent);
            padding: 16px 20px;
            margin: 20px 0;
            background: var(--bg-card);
            border-radius: 0 6px 6px 0;
        }

        .content blockquote p {
            color: var(--text-primary);
            font-size: 15px;
            margin-bottom: 0;
        }

        .content pre {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 16px 0;
        }

        .content pre code {
            font-family: 'SF Mono', 'Fira Code', 'Fira Mono', Menlo, Consolas, monospace;
            font-size: 13px;
            color: var(--text-primary);
            background: none;
            padding: 0;
        }

        .content code {
            font-family: 'SF Mono', 'Fira Code', 'Fira Mono', Menlo, Consolas, monospace;
            font-size: 13px;
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            color: var(--accent);
        }

        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 14px;
        }

        .content th {
            text-align: left;
            padding: 10px 14px;
            border-bottom: 2px solid var(--border);
            color: var(--text-primary);
            font-weight: 700;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .content td {
            padding: 10px 14px;
            border-bottom: 1px solid var(--border);
            color: var(--text-secondary);
        }

        .content strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .checklist {
            list-style: none;
            margin-left: 0;
            padding-left: 0;
        }

        .checklist li {
            padding-left: 28px;
            position: relative;
        }

        .checklist li::before {
            content: "\2705";
            position: absolute;
            left: 0;
        }

        .module-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 60px;
            padding-top: 32px;
            border-top: 1px solid var(--border);
        }

        .module-nav a {
            font-size: 14px;
            font-weight: 600;
            color: var(--accent);
        }

        .module-nav .prev::before {
            content: "\2190 ";
        }

        .module-nav .next::after {
            content: " \2192";
        }

        footer {
            padding: 40px 0;
            border-top: 1px solid var(--border);
        }

        footer .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-text {
            font-size: 13px;
            color: var(--text-tertiary);
        }

        .footer-links {
            display: flex;
            gap: 24px;
        }

        .footer-links a {
            font-size: 13px;
            color: var(--text-tertiary);
            transition: color 0.15s;
        }

        .footer-links a:hover {
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .content h1 {
                font-size: 28px;
            }

            .content h2 {
                font-size: 22px;
            }

            .content {
                padding: 0 0 60px;
            }

            footer .container {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }
        }
    </style>
</head>
<body>

    <nav>
        <div class="container">
            <a href="/" class="logo">Operator Foundry</a>
            <a href="https://shipitacademy.com" class="nav-link">ShipItAcademy.com</a>
        </div>
    </nav>

    <div class="content">
        <div class="container">
            <a href="/ship-os/" class="back-link">&larr; Back to Ship OS</a>
            <span class="track-badge track-a">Track A &mdash; Ship Systems</span>
            <h1>Module 04: Scaffold Agent</h1>

            <!-- WHAT YOU ARE BUILDING -->
            <h2>What You Are Building</h2>
            <p>A runnable project with the correct folder structure, an agent entry point that starts without errors, and stub functions for every tool in your architecture spec. When you finish this module, your agent runs, accepts input, and responds with placeholder output. No real logic yet &mdash; that comes next.</p>

            <!-- WHY IT MATTERS -->
            <h2>Why It Matters</h2>
            <p>Scaffolding before implementing forces you to validate your architecture before writing business logic. You catch dependency issues, import errors, and structural problems while the cost of fixing them is low. It also creates a clean commit checkpoint you can always roll back to. When you start implementing real capability in the next module, the entire structure is already settled &mdash; you just fill in the blanks.</p>

            <!-- STEP BY STEP -->
            <h2>Step-by-Step Instructions</h2>

            <h3>Step 1: Create the Folder Structure</h3>
            <p>Open your terminal and create the project directories. Choose the path that matches your language.</p>

            <h4>Python path</h4>
<pre><code>mkdir -p my-agent/src/tools
mkdir -p my-agent/tests
mkdir -p my-agent/docs
cd my-agent</code></pre>

            <h4>Node.js path</h4>
<pre><code>mkdir -p my-agent/src/tools
mkdir -p my-agent/tests
mkdir -p my-agent/docs
cd my-agent</code></pre>

            <p>Your directory should now look like this:</p>
<pre><code>my-agent/
  src/
    tools/
  tests/
  docs/</code></pre>

            <h3>Step 2: Initialize the Project</h3>

            <h4>Python path</h4>
<pre><code># Create a virtual environment
python -m venv venv
source venv/bin/activate    # macOS/Linux
# venv\Scripts\activate     # Windows

# Create requirements file
cat &gt; requirements.txt &lt;&lt; 'EOF'
openai&gt;=1.0.0
python-dotenv&gt;=1.0.0
EOF

# Install dependencies
pip install -r requirements.txt

# Create .env.example
cat &gt; .env.example &lt;&lt; 'EOF'
OPENAI_API_KEY=your-api-key-here
EOF

# Create your actual .env (do not commit this)
cp .env.example .env
# Now edit .env and add your real API key</code></pre>

            <h4>Node.js path</h4>
<pre><code># Initialize the project
npm init -y

# Install dependencies
npm install openai dotenv

# Create .env.example
cat &gt; .env.example &lt;&lt; 'EOF'
OPENAI_API_KEY=your-api-key-here
EOF

# Create your actual .env (do not commit this)
cp .env.example .env
# Now edit .env and add your real API key</code></pre>

            <p>Create a <code>.gitignore</code> file:</p>
<pre><code># .gitignore
.env
node_modules/
venv/
__pycache__/
*.pyc</code></pre>

            <h3>Step 3: Create the Agent Entry Point</h3>
            <p>This is the main file that initializes your agent, registers tools, and runs the interaction loop.</p>

            <h4>Python path &mdash; <code>src/agent.py</code></h4>
<pre><code>import os
from dotenv import load_dotenv
from openai import OpenAI

# Import your tool stubs
from tools.search import search
from tools.transform import transform
from tools.output import format_output

load_dotenv()

client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))

# Define tools for the OpenAI function-calling API
tools = [
    {
        "type": "function",
        "function": {
            "name": "search",
            "description": "Search for relevant information based on a query.",
            "parameters": {
                "type": "object",
                "properties": {
                    "query": {
                        "type": "string",
                        "description": "The search query"
                    }
                },
                "required": ["query"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "transform",
            "description": "Transform raw data into structured format.",
            "parameters": {
                "type": "object",
                "properties": {
                    "data": {
                        "type": "string",
                        "description": "The raw data to transform"
                    }
                },
                "required": ["data"]
            }
        }
    },
    {
        "type": "function",
        "function": {
            "name": "format_output",
            "description": "Format the final result for the user.",
            "parameters": {
                "type": "object",
                "properties": {
                    "content": {
                        "type": "string",
                        "description": "The content to format"
                    }
                },
                "required": ["content"]
            }
        }
    }
]

# Map function names to actual functions
tool_functions = {
    "search": search,
    "transform": transform,
    "format_output": format_output,
}

SYSTEM_PROMPT = """You are a helpful assistant.
Use your tools to answer the user's question.
Always use the search tool first, then transform the data,
then format the output."""

def run_agent(user_input):
    """Run the agent with a single user input and return the response."""
    messages = [
        {"role": "system", "content": SYSTEM_PROMPT},
        {"role": "user", "content": user_input}
    ]

    response = client.chat.completions.create(
        model="gpt-4o-mini",
        messages=messages,
        tools=tools,
    )

    message = response.choices[0].message

    # Handle tool calls if any
    if message.tool_calls:
        for tool_call in message.tool_calls:
            fn_name = tool_call.function.name
            import json
            fn_args = json.loads(tool_call.function.arguments)
            result = tool_functions[fn_name](**fn_args)
            messages.append(message)
            messages.append({
                "role": "tool",
                "tool_call_id": tool_call.id,
                "content": str(result)
            })

        final = client.chat.completions.create(
            model="gpt-4o-mini",
            messages=messages,
            tools=tools,
        )
        return final.choices[0].message.content

    return message.content

if __name__ == "__main__":
    print("Agent is running. Type 'quit' to exit.")
    print("Tools registered: search, transform, format_output")
    print("-" * 40)
    while True:
        user_input = input("\nYou: ")
        if user_input.lower() in ("quit", "exit"):
            break
        response = run_agent(user_input)
        print(f"\nAgent: {response}")</code></pre>

            <h4>Node.js path &mdash; <code>src/agent.js</code></h4>
<pre><code>require("dotenv").config();
const OpenAI = require("openai");
const readline = require("readline");

// Import your tool stubs
const { search } = require("./tools/search");
const { transform } = require("./tools/transform");
const { formatOutput } = require("./tools/output");

const client = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

// Define tools for the OpenAI function-calling API
const tools = [
  {
    type: "function",
    function: {
      name: "search",
      description: "Search for relevant information based on a query.",
      parameters: {
        type: "object",
        properties: {
          query: { type: "string", description: "The search query" }
        },
        required: ["query"]
      }
    }
  },
  {
    type: "function",
    function: {
      name: "transform",
      description: "Transform raw data into structured format.",
      parameters: {
        type: "object",
        properties: {
          data: { type: "string", description: "The raw data to transform" }
        },
        required: ["data"]
      }
    }
  },
  {
    type: "function",
    function: {
      name: "format_output",
      description: "Format the final result for the user.",
      parameters: {
        type: "object",
        properties: {
          content: { type: "string", description: "The content to format" }
        },
        required: ["content"]
      }
    }
  }
];

// Map function names to actual functions
const toolFunctions = {
  search,
  transform,
  format_output: formatOutput,
};

const SYSTEM_PROMPT = `You are a helpful assistant.
Use your tools to answer the user's question.
Always use the search tool first, then transform the data,
then format the output.`;

async function runAgent(userInput) {
  const messages = [
    { role: "system", content: SYSTEM_PROMPT },
    { role: "user", content: userInput }
  ];

  const response = await client.chat.completions.create({
    model: "gpt-4o-mini",
    messages,
    tools,
  });

  const message = response.choices[0].message;

  // Handle tool calls if any
  if (message.tool_calls) {
    messages.push(message);
    for (const toolCall of message.tool_calls) {
      const fnName = toolCall.function.name;
      const fnArgs = JSON.parse(toolCall.function.arguments);
      const result = toolFunctions[fnName](fnArgs);
      messages.push({
        role: "tool",
        tool_call_id: toolCall.id,
        content: String(result),
      });
    }

    const final = await client.chat.completions.create({
      model: "gpt-4o-mini",
      messages,
      tools,
    });
    return final.choices[0].message.content;
  }

  return message.content;
}

async function main() {
  console.log("Agent is running. Type 'quit' to exit.");
  console.log("Tools registered: search, transform, format_output");
  console.log("-".repeat(40));

  const rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout,
  });

  const askQuestion = () => {
    rl.question("\nYou: ", async (input) => {
      if (input.toLowerCase() === "quit" || input.toLowerCase() === "exit") {
        rl.close();
        return;
      }
      const response = await runAgent(input);
      console.log(`\nAgent: ${response}`);
      askQuestion();
    });
  };

  askQuestion();
}

main();</code></pre>

            <h3>Step 4: Create Tool Stubs</h3>
            <p>Create one file per tool. Each stub has the correct function signature, a docstring describing what it will do, and returns placeholder data. Replace the example tool names below with the actual tools from your architecture spec.</p>

            <h4>Python path</h4>
            <p>Create <code>src/tools/__init__.py</code> (empty file to make it a package):</p>
<pre><code># src/tools/__init__.py</code></pre>

            <p>Create <code>src/tools/search.py</code>:</p>
<pre><code>def search(query: str) -&gt; str:
    """Search for relevant information based on a query.

    TODO: Replace with real search logic (API call, database query, etc.)
    """
    return f"[STUB] Search results for: {query}"</code></pre>

            <p>Create <code>src/tools/transform.py</code>:</p>
<pre><code>def transform(data: str) -&gt; str:
    """Transform raw data into structured format.

    TODO: Replace with real transformation logic.
    """
    return f"[STUB] Transformed data: {data}"</code></pre>

            <p>Create <code>src/tools/output.py</code>:</p>
<pre><code>def format_output(content: str) -&gt; str:
    """Format the final result for the user.

    TODO: Replace with real formatting logic.
    """
    return f"[STUB] Formatted output: {content}"</code></pre>

            <h4>Node.js path</h4>
            <p>Create <code>src/tools/search.js</code>:</p>
<pre><code>/**
 * Search for relevant information based on a query.
 * TODO: Replace with real search logic (API call, database query, etc.)
 */
function search({ query }) {
  return `[STUB] Search results for: ${query}`;
}

module.exports = { search };</code></pre>

            <p>Create <code>src/tools/transform.js</code>:</p>
<pre><code>/**
 * Transform raw data into structured format.
 * TODO: Replace with real transformation logic.
 */
function transform({ data }) {
  return `[STUB] Transformed data: ${data}`;
}

module.exports = { transform };</code></pre>

            <p>Create <code>src/tools/output.js</code>:</p>
<pre><code>/**
 * Format the final result for the user.
 * TODO: Replace with real formatting logic.
 */
function formatOutput({ content }) {
  return `[STUB] Formatted output: ${content}`;
}

module.exports = { formatOutput };</code></pre>

            <h3>Step 5: Run It and Verify</h3>
            <p>Start your agent and confirm it runs without errors.</p>

            <h4>Python path</h4>
<pre><code>cd my-agent
python src/agent.py</code></pre>

            <h4>Node.js path</h4>
<pre><code>cd my-agent
node src/agent.js</code></pre>

            <p>You should see:</p>
<pre><code>Agent is running. Type 'quit' to exit.
Tools registered: search, transform, format_output
----------------------------------------</code></pre>

            <p>Type a test message. The agent should respond &mdash; possibly calling your stub tools, which return placeholder text. That is correct. The agent runs, the tools are wired up, the structure works.</p>

            <h3>Step 6: Commit Your Scaffold</h3>
<pre><code>git init
git add -A
git commit -m "scaffold: agent skeleton with tool stubs"</code></pre>

            <!-- ARTIFACT TEMPLATE -->
            <h2>Artifact Template</h2>
            <p>Your completed scaffold should have this structure. Copy and adapt it to match your system's actual tool names from your architecture spec.</p>
<pre><code>my-agent/
  .env.example              # Required env vars (no secrets)
  .gitignore                # Excludes .env, node_modules, venv, etc.
  requirements.txt          # Python: pinned dependencies
  # or package.json         # Node: dependencies
  src/
    agent.py                # Main agent entry point
    # or agent.js
    tools/
      __init__.py           # Python only
      search.py             # Stub: correct signature, returns placeholder
      transform.py          # Stub: correct signature, returns placeholder
      output.py             # Stub: correct signature, returns placeholder
      # or search.js, transform.js, output.js
  tests/                    # Empty for now (Module 06)
  docs/
    system-definition.md    # From Module 02
    architecture-spec.md    # From Module 03
  README.md                 # What the system does, how to run it</code></pre>

            <!-- EXAMPLE OUTPUT -->
            <h2>Example Output</h2>
            <p>Here is what a working scaffold session looks like:</p>
<pre><code>$ python src/agent.py
Agent is running. Type 'quit' to exit.
Tools registered: search, transform, format_output
----------------------------------------

You: What is the weather in Tokyo?

Agent: I searched for weather information about Tokyo.
Here are the results: [STUB] Formatted output:
[STUB] Transformed data: [STUB] Search results for: weather in Tokyo

You: quit</code></pre>
            <p>The output contains <code>[STUB]</code> placeholders everywhere. That is exactly right. The structure works. The tools are called in order. Real logic comes in Module 05.</p>

            <!-- COMMON ISSUES -->
            <h2>Common Issues</h2>
            <table>
                <thead>
                    <tr>
                        <th>Problem</th>
                        <th>Fix</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Missing API key</td>
                        <td>Check your <code>.env</code> file. Confirm the key is set and the file is in the project root.</td>
                    </tr>
                    <tr>
                        <td>Import errors (Python)</td>
                        <td>Run <code>pip install -r requirements.txt</code>. Make sure <code>__init__.py</code> exists in the tools folder.</td>
                    </tr>
                    <tr>
                        <td>Module not found (Node)</td>
                        <td>Run <code>npm install</code>. Check that require paths match your file names.</td>
                    </tr>
                    <tr>
                        <td>Agent won't start</td>
                        <td>Check the entry point. Confirm the <code>if __name__</code> block (Python) or <code>main()</code> call (Node) exists at the bottom of the file.</td>
                    </tr>
                    <tr>
                        <td>Tool not registered</td>
                        <td>Verify the tool definition in the <code>tools</code> array matches the function name in <code>tool_functions</code>.</td>
                    </tr>
                    <tr>
                        <td>Wrong SDK version</td>
                        <td>Check <code>requirements.txt</code> or <code>package.json</code> for version pinning. The OpenAI SDK v1+ is required.</td>
                    </tr>
                    <tr>
                        <td>Tool called but returns error</td>
                        <td>Check that the stub function signature matches the parameters defined in the tool spec.</td>
                    </tr>
                </tbody>
            </table>

            <!-- DONE CRITERIA -->
            <h2>Done Criteria</h2>
            <ul class="checklist">
                <li>Repository initialized with correct folder structure</li>
                <li>Dependencies installed and <code>.env.example</code> created</li>
                <li><code>.gitignore</code> excludes secrets and build artifacts</li>
                <li>Agent entry point created and runnable</li>
                <li>System prompt written (adapted from your system definition)</li>
                <li>All tools stubbed with correct function signatures</li>
                <li>All tools registered with the agent</li>
                <li>Agent starts without errors</li>
                <li>Agent responds to basic input (even with placeholder output)</li>
                <li>Code committed: <code>git commit -m "scaffold: agent skeleton with tool stubs"</code></li>
            </ul>

            <div class="module-nav">
                <div><a href="03-design-spec.html" class="prev">Module 03: Design Spec</a></div>
                <div><a href="05-implement-capability.html" class="next">Module 05: Implement Capability</a></div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container">
            <span class="footer-text">Operator Foundry &mdash; <a href="https://shipitacademy.com" style="color:inherit;text-decoration:underline;text-underline-offset:3px;">ShipItAcademy.com</a></span>
            <div class="footer-links">
                <a href="/">Home</a>
                <a href="/privacy.html">Privacy Policy</a>
            </div>
        </div>
    </footer>

</body>
</html>